<?php

$form = $this->form;
$param=$this->param;
$comContractUuid=$this->comContractUuid;
$form->setAttribute('action', $this->url('company', array('action' => 'createCompany', 'org_id' => $this->org_id,'id'=>$param, 'comId'=>$comContractUuid)))
    ->prepare();

echo $this->form()->openTag($form);
//$whoGave= $form->get('whoGave');
//echo $this->formRow($serialNumber);
?>
<div class="companyAdd">
<?php


echo $this->formRow($form->get('name'));
echo $this->formRow($form->get('property'));
echo $this->formRow($form->get('generalManager'));
echo $this->formRow($form->get('official'));
echo $this->formRow($form->get('chiefAccountant'));
echo $this->formRow($form->get('note'));
// echo $this->formCollection()->renderTemplate($form->get('address'));
?>
    <div class="address">
        <?php echo '<div class="template">'.$this->formCollection($form->get('address')->getTemplateElement()).'</div>';
        foreach($form->get('address') as $newForm) {
            echo '<fieldset>'.$this->formCollection($newForm).'</fieldset>';
        } ?>
    </div>
    <button type="button" onclick="addItem('address');">Добавить еще адресс</button>

    <div class="contact">
        <?php echo '<div class="template">'.$this->formCollection($form->get('contact')->getTemplateElement()).'</div>';
        foreach($form->get('contact') as $newForm) {
            echo '<fieldset>'.$this->formCollection($newForm).'</fieldset>';
        } ?>
    </div>
    <button type="button" onclick="addItem('contact');">Добавить контакт</button>

    <script>
        function addItem(item) {
            var currentCount = $('.'+item+' .counter').val();
            if(typeof currentCount=== 'undefined') {
                $('.'+item).append("<input type='hidden' class='counter' value='1'>");
                currentCount=1;
            }
            var template=$('.'+item+' .template').html();
            template = template.replace(/__index__/g, currentCount);

            $('.'+item).append('<fieldset>'+template+'</fieldset>');
            currentCount++;
            $('.'+item+' .counter').val(currentCount);
        }
        function deleteFieldset(element) {
            var conf = confirm('Вы действительно хотите удалить элемент?');
            if (!conf) {
                return false;
            }
            else {
                $(element).parent().remove();
            }

        }

    </script>

    <?php
echo $this->formRow($form->get('requisites'));
echo $this->formRow($form->get('inn'));
echo $this->formRow($form->get('kpp'));
echo $this->formRow($form->get('okv'));
echo $this->formRow($form->get('personal'));

echo $this->formElement($form->get('submit'));
echo $this->form()->closeTag();
?>
</div>

<?php

?> <a href="<?php echo $this->url('account', array('action' => 'index')); ?>">Вернуться в аккаунт</a>
